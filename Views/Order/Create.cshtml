@model Susurros_del_Cafe_WEB.ViewModels.OrderViewModel
@{
    ViewData["Title"] = "Realizar Pedido";
    
    // Obtener productos desde ViewBag
    var products = ViewBag.Products as List<Susurros_del_Cafe_WEB.Models.Product> ?? new List<Susurros_del_Cafe_WEB.Models.Product>();
    
    // Definir variables de productos
    var medioMolido250 = products.FirstOrDefault(p => p.Name == "Tueste Medio Molido 250g");
    var medioMolido500 = products.FirstOrDefault(p => p.Name == "Tueste Medio Molido 500g");
    var oscuroMolido250 = products.FirstOrDefault(p => p.Name == "Tueste Oscuro Molido 250g");
    var oscuroMolido500 = products.FirstOrDefault(p => p.Name == "Tueste Oscuro Molido 500g");
    var medioGrano250 = products.FirstOrDefault(p => p.Name == "Tueste Medio en Grano 250g");
    var medioGrano500 = products.FirstOrDefault(p => p.Name == "Tueste Medio en Grano 500g");
}

<!-- Hero Section del Pedido -->
<section style="background: linear-gradient(135deg, var(--coffee-primary) 0%, var(--coffee-rich) 100%); padding: 3rem 0; color: white;">
    <div class="container text-center">
        <h1 class="display-4 mb-3" style="font-weight: 700;">Realizar Pedido</h1>
        <p class="lead" style="opacity: 0.9;">Selecciona entre nuestras 6 variedades de café artesanal y completa tu información</p>
    </div>
</section>

<div class="container" style="margin-top: -2rem; margin-bottom: 4rem;">
    <div class="row">
        <!-- Formulario Principal -->
        <div class="col-lg-8">
            <div class="card" style="border-radius: 20px; box-shadow: var(--shadow-medium); border: none; background: white;">
                <div class="card-body" style="padding: 3rem;">
                    <form asp-action="Create" method="post" id="orderForm">
                        <div asp-validation-summary="ModelOnly" class="alert alert-danger" style="border-radius: 15px;"></div>

                        <!-- Filtros de Productos -->
                        <div class="text-center mb-4">
                            <div class="btn-group" role="group">
                                <button type="button" class="btn btn-outline-secondary btn-sm active" data-filter="all">
                                    Todos
                                </button>
                                <button type="button" class="btn btn-outline-secondary btn-sm" data-filter="molido">
                                    Molido
                                </button>
                                <button type="button" class="btn btn-outline-secondary btn-sm" data-filter="grano">
                                    En Grano
                                </button>
                            </div>
                        </div>

                        <!-- Sección de Productos - 6 productos -->
                        <div class="row g-3">

                            <!-- TUESTE MEDIO MOLIDO 250g -->
                            <div class="col-md-6 col-lg-4" data-category="molido" style="@(medioMolido250?.Stock == 0 ? "display: none;" : "")">
                                <div class="product-card h-100 @(medioMolido250?.Stock == 0 ? "out-of-stock" : "")" style="padding: 1.5rem; border-radius: 16px; transition: var(--transition);">
                                    <div class="text-center">
                                        <div class="product-badge mb-2">
                                            @if (medioMolido250?.Stock == 0)
                                            {
                                                <span class="badge bg-danger">❌ Agotado</span>
                                            }
                                            else
                                            {
                                                <span class="badge bg-warning text-dark">🌟 Popular</span>
                                            }
                                        </div>
                                        <div class="product-image-container mb-3">
                                            <img src="~/images/products/Bolsa Tueste medio 250g.png"
                                                 alt="Tueste Medio Molido 250g"
                                                 class="order-product-image"
                                                 style="width: 80px; height: 80px; object-fit: cover; border-radius: 12px; box-shadow: var(--shadow-soft);">
                                        </div>
                                        <h6 style="color: var(--coffee-dark); margin-bottom: 0.5rem;">Tueste Medio Molido</h6>
                                        <p style="color: var(--text-light); font-size: 0.8rem; margin-bottom: 0.5rem;">250g</p>
                                        <div style="font-size: 1.2rem; font-weight: 700; color: var(--coffee-primary); margin-bottom: 1rem;">₡2,500</div>

                                        <div class="quantity-controls">
                                            <button type="button" class="quantity-btn" onclick="changeQuantity('QuantityMedioMolido250g', -1)" @(medioMolido250?.Stock == 0 ? "disabled" : "")>
                                                <i class="fas fa-minus"></i>
                                            </button>
                                            <input asp-for="QuantityMedioMolido250g" class="quantity-input" min="0" max="@(medioMolido250?.Stock ?? 50)" disabled="@(medioMolido250?.Stock == 0)" />
                                            <button type="button" class="quantity-btn" onclick="changeQuantity('QuantityMedioMolido250g', 1)" @(medioMolido250?.Stock == 0 ? "disabled" : "")>
                                                <i class="fas fa-plus"></i>
                                            </button>
                                        </div>
                                        @if (medioMolido250?.Stock == 0)
                                        {
                                            <small class="text-danger mt-2 d-block">Producto agotado</small>
                                        }
                                        else if (medioMolido250?.Stock <= 5)
                                        {
                                            <small class="text-warning mt-2 d-block">¡Solo quedan @(medioMolido250.Stock) unidades!</small>
                                        }
                                        <span asp-validation-for="QuantityMedioMolido250g" class="text-danger small"></span>
                                    </div>
                                </div>
                            </div>

                            <!-- TUESTE MEDIO MOLIDO 500g -->
                            <div class="col-md-6 col-lg-4" data-category="molido" style="@(medioMolido500?.Stock == 0 ? "display: none;" : "")">
                                <div class="product-card h-100 @(medioMolido500?.Stock == 0 ? "out-of-stock" : "")" style="padding: 1.5rem; border-radius: 16px; transition: var(--transition);">
                                    <div class="text-center">
                                        <div class="product-badge mb-2">
                                            @if (medioMolido500?.Stock == 0)
                                            {
                                                <span class="badge bg-danger">❌ Agotado</span>
                                            }
                                            else
                                            {
                                                <span class="badge bg-success">💰 Valor</span>
                                            }
                                        </div>
                                        <div class="product-image-container mb-3">
                                            <img src="~/images/products/Bolsa Tueste medio 250g.png"
                                                 alt="Tueste Medio Molido 500g"
                                                 class="order-product-image"
                                                 style="width: 80px; height: 80px; object-fit: cover; border-radius: 12px; box-shadow: var(--shadow-soft);">
                                        </div>
                                        <h6 style="color: var(--coffee-dark); margin-bottom: 0.5rem;">Tueste Medio Molido</h6>
                                        <p style="color: var(--text-light); font-size: 0.8rem; margin-bottom: 0.5rem;">500g</p>
                                        <div style="font-size: 1.2rem; font-weight: 700; color: var(--coffee-primary); margin-bottom: 1rem;">₡4,500</div>

                                        <div class="quantity-controls">
                                            <button type="button" class="quantity-btn" onclick="changeQuantity('QuantityMedioMolido500g', -1)" @(medioMolido500?.Stock == 0 ? "disabled" : "")>
                                                <i class="fas fa-minus"></i>
                                            </button>
                                            <input asp-for="QuantityMedioMolido500g" class="quantity-input" min="0" max="@(medioMolido500?.Stock ?? 50)" disabled="@(medioMolido500?.Stock == 0)" />
                                            <button type="button" class="quantity-btn" onclick="changeQuantity('QuantityMedioMolido500g', 1)" @(medioMolido500?.Stock == 0 ? "disabled" : "")>
                                                <i class="fas fa-plus"></i>
                                            </button>
                                        </div>
                                        @if (medioMolido500?.Stock == 0)
                                        {
                                            <small class="text-danger mt-2 d-block">Producto agotado</small>
                                        }
                                        else if (medioMolido500?.Stock <= 5)
                                        {
                                            <small class="text-warning mt-2 d-block">¡Solo quedan @(medioMolido500.Stock) unidades!</small>
                                        }
                                        <span asp-validation-for="QuantityMedioMolido500g" class="text-danger small"></span>
                                    </div>
                                </div>
                            </div>

                            <!-- TUESTE OSCURO MOLIDO 250g -->
                            <div class="col-md-6 col-lg-4" data-category="molido" style="@(oscuroMolido250?.Stock == 0 ? "display: none;" : "")">
                                <div class="product-card h-100 @(oscuroMolido250?.Stock == 0 ? "out-of-stock" : "")" style="padding: 1.5rem; border-radius: 16px; transition: var(--transition);">
                                    <div class="text-center">
                                        <div class="product-badge mb-2">
                                            @if (oscuroMolido250?.Stock == 0)
                                            {
                                                <span class="badge bg-danger">❌ Agotado</span>
                                            }
                                            else
                                            {
                                                <span class="badge bg-dark text-white">🔥 Intenso</span>
                                            }
                                        </div>
                                        <div class="product-image-container mb-3">
                                            <img src="~/images/products/Bolsa Tueste Oscuro 250g.png"
                                                 alt="Tueste Oscuro Molido 250g"
                                                 class="order-product-image"
                                                 style="width: 80px; height: 80px; object-fit: cover; border-radius: 12px; box-shadow: var(--shadow-soft);">
                                        </div>
                                        <h6 style="color: var(--coffee-dark); margin-bottom: 0.5rem;">Tueste Oscuro Molido</h6>
                                        <p style="color: var(--text-light); font-size: 0.8rem; margin-bottom: 0.5rem;">250g</p>
                                        <div style="font-size: 1.2rem; font-weight: 700; color: var(--coffee-primary); margin-bottom: 1rem;">₡2,500</div>

                                        <div class="quantity-controls">
                                            <button type="button" class="quantity-btn" onclick="changeQuantity('QuantityOscuroMolido250g', -1)" @(oscuroMolido250?.Stock == 0 ? "disabled" : "")>
                                                <i class="fas fa-minus"></i>
                                            </button>
                                            <input asp-for="QuantityOscuroMolido250g" class="quantity-input" min="0" max="@(oscuroMolido250?.Stock ?? 50)" disabled="@(oscuroMolido250?.Stock == 0)" />
                                            <button type="button" class="quantity-btn" onclick="changeQuantity('QuantityOscuroMolido250g', 1)" @(oscuroMolido250?.Stock == 0 ? "disabled" : "")>
                                                <i class="fas fa-plus"></i>
                                            </button>
                                        </div>
                                        @if (oscuroMolido250?.Stock == 0)
                                        {
                                            <small class="text-danger mt-2 d-block">Producto agotado</small>
                                        }
                                        else if (oscuroMolido250?.Stock <= 5)
                                        {
                                            <small class="text-warning mt-2 d-block">¡Solo quedan @(oscuroMolido250.Stock) unidades!</small>
                                        }
                                        <span asp-validation-for="QuantityOscuroMolido250g" class="text-danger small"></span>
                                    </div>
                                </div>
                            </div>

                            <!-- TUESTE OSCURO MOLIDO 500g -->
                            <div class="col-md-6 col-lg-4" data-category="molido" style="@(oscuroMolido500?.Stock == 0 ? "display: none;" : "")">
                                <div class="product-card h-100 @(oscuroMolido500?.Stock == 0 ? "out-of-stock" : "")" style="padding: 1.5rem; border-radius: 16px; transition: var(--transition);">
                                    <div class="text-center">
                                        <div class="product-badge mb-2">
                                            @if (oscuroMolido500?.Stock == 0)
                                            {
                                                <span class="badge bg-danger">❌ Agotado</span>
                                            }
                                            else
                                            {
                                                <span class="badge bg-dark text-white">🔥 Familiar</span>
                                            }
                                        </div>
                                        <div class="product-image-container mb-3">
                                            <img src="~/images/products/Bolsa Tueste Oscuro 250g.png"
                                                 alt="Tueste Oscuro Molido 500g"
                                                 class="order-product-image"
                                                 style="width: 80px; height: 80px; object-fit: cover; border-radius: 12px; box-shadow: var(--shadow-soft);">
                                        </div>
                                        <h6 style="color: var(--coffee-dark); margin-bottom: 0.5rem;">Tueste Oscuro Molido</h6>
                                        <p style="color: var(--text-light); font-size: 0.8rem; margin-bottom: 0.5rem;">500g</p>
                                        <div style="font-size: 1.2rem; font-weight: 700; color: var(--coffee-primary); margin-bottom: 1rem;">₡4,500</div>

                                        <div class="quantity-controls">
                                            <button type="button" class="quantity-btn" onclick="changeQuantity('QuantityOscuroMolido500g', -1)" @(oscuroMolido500?.Stock == 0 ? "disabled" : "")>
                                                <i class="fas fa-minus"></i>
                                            </button>
                                            <input asp-for="QuantityOscuroMolido500g" class="quantity-input" min="0" max="@(oscuroMolido500?.Stock ?? 50)" disabled="@(oscuroMolido500?.Stock == 0)" />
                                            <button type="button" class="quantity-btn" onclick="changeQuantity('QuantityOscuroMolido500g', 1)" @(oscuroMolido500?.Stock == 0 ? "disabled" : "")>
                                                <i class="fas fa-plus"></i>
                                            </button>
                                        </div>
                                        @if (oscuroMolido500?.Stock == 0)
                                        {
                                            <small class="text-danger mt-2 d-block">Producto agotado</small>
                                        }
                                        else if (oscuroMolido500?.Stock <= 5)
                                        {
                                            <small class="text-warning mt-2 d-block">¡Solo quedan @(oscuroMolido500.Stock) unidades!</small>
                                        }
                                        <span asp-validation-for="QuantityOscuroMolido500g" class="text-danger small"></span>
                                    </div>
                                </div>
                            </div>

                            <!-- TUESTE MEDIO EN GRANO 250g -->
                            <div class="col-md-6 col-lg-4" data-category="grano" style="@(medioGrano250?.Stock == 0 ? "display: none;" : "")">
                                <div class="product-card h-100 @(medioGrano250?.Stock == 0 ? "out-of-stock" : "")" style="padding: 1.5rem; border-radius: 16px; transition: var(--transition);">
                                    <div class="text-center">
                                        <div class="product-badge mb-2">
                                            @if (medioGrano250?.Stock == 0)
                                            {
                                                <span class="badge bg-danger">❌ Agotado</span>
                                            }
                                            else
                                            {
                                                <span class="badge bg-info text-dark">🫘 Grano</span>
                                            }
                                        </div>
                                        <div class="product-image-container mb-3">
                                            <img src="~/images/products/Bolsa Tueste medio en grano 250g.png"
                                                 alt="Tueste Medio en Grano 250g"
                                                 class="order-product-image"
                                                 style="width: 80px; height: 80px; object-fit: cover; border-radius: 12px; box-shadow: var(--shadow-soft);">
                                        </div>
                                        <h6 style="color: var(--coffee-dark); margin-bottom: 0.5rem;">Tueste Medio en Grano</h6>
                                        <p style="color: var(--text-light); font-size: 0.8rem; margin-bottom: 0.5rem;">250g</p>
                                        <div style="font-size: 1.2rem; font-weight: 700; color: var(--coffee-primary); margin-bottom: 1rem;">₡2,500</div>

                                        <div class="quantity-controls">
                                            <button type="button" class="quantity-btn" onclick="changeQuantity('QuantityMedioGrano250g', -1)" @(medioGrano250?.Stock == 0 ? "disabled" : "")>
                                                <i class="fas fa-minus"></i>
                                            </button>
                                            <input asp-for="QuantityMedioGrano250g" class="quantity-input" min="0" max="@(medioGrano250?.Stock ?? 50)" disabled="@(medioGrano250?.Stock == 0)" />
                                            <button type="button" class="quantity-btn" onclick="changeQuantity('QuantityMedioGrano250g', 1)" @(medioGrano250?.Stock == 0 ? "disabled" : "")>
                                                <i class="fas fa-plus"></i>
                                            </button>
                                        </div>
                                        @if (medioGrano250?.Stock == 0)
                                        {
                                            <small class="text-danger mt-2 d-block">Producto agotado</small>
                                        }
                                        else if (medioGrano250?.Stock <= 5)
                                        {
                                            <small class="text-warning mt-2 d-block">¡Solo quedan @(medioGrano250.Stock) unidades!</small>
                                        }
                                        <span asp-validation-for="QuantityMedioGrano250g" class="text-danger small"></span>
                                    </div>
                                </div>
                            </div>

                            <!-- TUESTE MEDIO EN GRANO 500g -->
                            <div class="col-md-6 col-lg-4" data-category="grano" style="@(medioGrano500?.Stock == 0 ? "display: none;" : "")">
                                <div class="product-card h-100 @(medioGrano500?.Stock == 0 ? "out-of-stock" : "")" style="padding: 1.5rem; border-radius: 16px; transition: var(--transition);">
                                    <div class="text-center">
                                        <div class="product-badge mb-2">
                                            @if (medioGrano500?.Stock == 0)
                                            {
                                                <span class="badge bg-danger">❌ Agotado</span>
                                            }
                                            else
                                            {
                                                <span class="badge bg-info text-dark">🫘 Premium</span>
                                            }
                                        </div>
                                        <div class="product-image-container mb-3">
                                            <img src="~/images/products/Bolsa Tueste medio en grano 250g.png"
                                                 alt="Tueste Medio en Grano 500g"
                                                 class="order-product-image"
                                                 style="width: 80px; height: 80px; object-fit: cover; border-radius: 12px; box-shadow: var(--shadow-soft);">
                                        </div>
                                        <h6 style="color: var(--coffee-dark); margin-bottom: 0.5rem;">Tueste Medio en Grano</h6>
                                        <p style="color: var(--text-light); font-size: 0.8rem; margin-bottom: 0.5rem;">500g</p>
                                        <div style="font-size: 1.2rem; font-weight: 700; color: var(--coffee-primary); margin-bottom: 1rem;">₡4,500</div>

                                        <div class="quantity-controls">
                                            <button type="button" class="quantity-btn" onclick="changeQuantity('QuantityMedioGrano500g', -1)" @(medioGrano500?.Stock == 0 ? "disabled" : "")>
                                                <i class="fas fa-minus"></i>
                                            </button>
                                            <input asp-for="QuantityMedioGrano500g" class="quantity-input" min="0" max="@(medioGrano500?.Stock ?? 50)" disabled="@(medioGrano500?.Stock == 0)" />
                                            <button type="button" class="quantity-btn" onclick="changeQuantity('QuantityMedioGrano500g', 1)" @(medioGrano500?.Stock == 0 ? "disabled" : "")>
                                                <i class="fas fa-plus"></i>
                                            </button>
                                        </div>
                                        @if (medioGrano500?.Stock == 0)
                                        {
                                            <small class="text-danger mt-2 d-block">Producto agotado</small>
                                        }
                                        else if (medioGrano500?.Stock <= 5)
                                        {
                                            <small class="text-warning mt-2 d-block">¡Solo quedan @(medioGrano500.Stock) unidades!</small>
                                        }
                                        <span asp-validation-for="QuantityMedioGrano500g" class="text-danger small"></span>
                                    </div>
                                </div>
                            </div>

                        </div>

                        <!-- Información del Cliente -->
                        <div class="mb-5 mt-5">
                            <div class="d-flex align-items-center mb-4">
                                <i class="fas fa-user" style="font-size: 1.5rem; color: var(--coffee-secondary); margin-right: 0.75rem;"></i>
                                <h4 class="mb-0" style="color: var(--coffee-dark);">Información de Contacto</h4>
                            </div>

                            <div class="row g-3">
                                <div class="col-md-6">
                                    <label asp-for="CustomerName" class="form-label"></label>
                                    <input asp-for="CustomerName" class="form-control" placeholder="Tu nombre completo" />
                                    <span asp-validation-for="CustomerName" class="text-danger small"></span>
                                </div>
                                <div class="col-md-6">
                                    <label for="CustomerEmail" class="form-label">
                                        <i class="fas fa-envelope me-2"></i>Correo Electrónico *
                                    </label>
                                    <input type="email" class="form-control" id="CustomerEmail" name="CustomerEmail" required
                                           placeholder="ejemplo@gmail.com">
                                </div>
                                <div class="col-md-6">
                                    <label asp-for="CustomerPhone" class="form-label"></label>
                                    <input asp-for="CustomerPhone" class="form-control" placeholder="8888-8888" />
                                    <span asp-validation-for="CustomerPhone" class="text-danger small"></span>
                                </div>
                            </div>
                        </div>

                        <!-- Información de Entrega -->
                        <div class="mb-5">
                            <div class="d-flex align-items-center mb-4">
                                <i class="fas fa-map-marker-alt" style="font-size: 1.5rem; color: var(--coffee-secondary); margin-right: 0.75rem;"></i>
                                <h4 class="mb-0" style="color: var(--coffee-dark);">Información de Entrega</h4>
                            </div>

                            <div class="row g-3">
                                <div class="col-md-6">
                                    <label asp-for="Province" class="form-label"></label>
                                    <select asp-for="Province" class="form-select" id="Province">
                                        <option value="">Seleccione una provincia</option>
                                        <option value="Alajuela">Alajuela</option>
                                        <option value="San José">San José</option>
                                        <option value="Cartago">Cartago</option>
                                        <option value="Heredia">Heredia</option>
                                        <option value="Guanacaste">Guanacaste</option>
                                        <option value="Puntarenas">Puntarenas</option>
                                        <option value="Limón">Limón</option>
                                    </select>
                                    <span asp-validation-for="Province" class="text-danger small"></span>
                                </div>
                                <div class="col-md-6">
                                    <label asp-for="PaymentMethod" class="form-label"></label>
                                    <select asp-for="PaymentMethod" class="form-select">
                                        <option value="">Seleccione método de pago</option>
                                        <option value="1">Efectivo contra entrega</option>
                                        <option value="2">SINPE Móvil(6022-4167)</option>
                                    </select>
                                    <span asp-validation-for="PaymentMethod" class="text-danger small"></span>
                                </div>
                            </div>

                            <div class="mt-3">
                                <label asp-for="CustomerAddress" class="form-label"></label>
                                <textarea asp-for="CustomerAddress" class="form-control" rows="3" placeholder="Dirección completa de entrega..."></textarea>
                                <span asp-validation-for="CustomerAddress" class="text-danger small"></span>
                            </div>

                            <div class="mt-3">
                                <label asp-for="Comments" class="form-label">Comentarios Adicionales (Opcional)</label>
                                <textarea asp-for="Comments" class="form-control" rows="2" placeholder="Instrucciones especiales, referencias, etc..."></textarea>
                                <span asp-validation-for="Comments" class="text-danger small"></span>
                            </div>
                        </div>

                        <!-- Botón de Envío -->
                        <div class="text-center">
                            <button type="submit" class="btn btn-coffee btn-lg" style="padding: 1rem 3rem; font-size: 1.1rem;">
                                <i class="fas fa-check-circle me-2"></i>Confirmar Pedido
                            </button>
                        </div>
                    </form>
                </div>
            </div>
        </div>

        <!-- Resumen del Pedido -->
        <div class="col-lg-4">
            <div class="order-summary" id="order-summary" style="display: none;">
                <div class="summary-header">
                    <h5 class="mb-0"><i class="fas fa-receipt me-2"></i>Resumen del Pedido</h5>
                </div>
                <div class="card-body" style="padding: 2rem;">
                    <!-- Items del pedido - 6 productos -->
                    <div id="item-medio-molido-250" style="display: none;">
                        <div class="summary-item">
                            <span>Tueste Medio Molido 250g x<span id="summary-qty-medio-molido-250">0</span></span>
                            <span id="summary-price-medio-molido-250">₡0</span>
                        </div>
                    </div>
                    <div id="item-medio-molido-500" style="display: none;">
                        <div class="summary-item">
                            <span>Tueste Medio Molido 500g x<span id="summary-qty-medio-molido-500">0</span></span>
                            <span id="summary-price-medio-molido-500">₡0</span>
                        </div>
                    </div>
                    <div id="item-oscuro-molido-250" style="display: none;">
                        <div class="summary-item">
                            <span>Tueste Oscuro Molido 250g x<span id="summary-qty-oscuro-molido-250">0</span></span>
                            <span id="summary-price-oscuro-molido-250">₡0</span>
                        </div>
                    </div>
                    <div id="item-oscuro-molido-500" style="display: none;">
                        <div class="summary-item">
                            <span>Tueste Oscuro Molido 500g x<span id="summary-qty-oscuro-molido-500">0</span></span>
                            <span id="summary-price-oscuro-molido-500">₡0</span>
                        </div>
                    </div>
                    <div id="item-medio-grano-250" style="display: none;">
                        <div class="summary-item">
                            <span>Tueste Medio Grano 250g x<span id="summary-qty-medio-grano-250">0</span></span>
                            <span id="summary-price-medio-grano-250">₡0</span>
                        </div>
                    </div>
                    <div id="item-medio-grano-500" style="display: none;">
                        <div class="summary-item">
                            <span>Tueste Medio Grano 500g x<span id="summary-qty-medio-grano-500">0</span></span>
                            <span id="summary-price-medio-grano-500">₡0</span>
                        </div>
                    </div>

                    <hr style="border-color: var(--coffee-light);">

                    <!-- Totales -->
                    <div class="summary-item">
                        <span>Subtotal:</span>
                        <span id="summary-subtotal">₡0</span>
                    </div>
                    <div class="summary-item">
                        <span>Envío:</span>
                        <span id="summary-shipping">₡0</span>
                    </div>
                    <div class="small text-muted mb-3" id="shipping-info"></div>

                    <div class="summary-total">
                        <div class="d-flex justify-content-between align-items-center">
                            <span style="font-size: 1.2rem;">Total:</span>
                            <span id="summary-total" style="font-size: 1.4rem; color: var(--coffee-primary);">₡0</span>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Información adicional -->
            <div class="card mt-4" style="border-radius: 16px; border: 1px solid var(--coffee-light);">
                <div class="card-body" style="padding: 2rem;">
                    <h6 style="color: var(--coffee-dark); margin-bottom: 1rem;">
                        <i class="fas fa-info-circle me-2" style="color: var(--coffee-secondary);"></i>
                        Información Importante
                    </h6>
                    <ul class="list-unstyled small" style="color: var(--text-light); line-height: 1.6;">
                        <li class="mb-2"><i class="fas fa-truck me-2" style="color: var(--coffee-secondary);"></i>Envío gratis a alrededores de Alajuela centro</li>
                        <li class="mb-2"><i class="fas fa-phone me-2" style="color: var(--coffee-secondary);"></i>Te contactaremos para confirmar</li>
                        <li class="mb-2"><i class="fas fa-clock me-2" style="color: var(--coffee-secondary);"></i>Entrega en 48-76 horas</li>
                        <li><i class="fas fa-shield-alt me-2" style="color: var(--coffee-secondary);"></i>Garantía de frescura</li>
                    </ul>
                </div>
            </div>
        </div>
    </div>
</div>

@section Scripts {
    <script src="~/js/order-calculator-6products.js"></script>
    <script>
        function changeQuantity(inputId, change) {
            const input = document.getElementById(inputId);
            if (input.disabled) return;
            
            const currentValue = parseInt(input.value) || 0;
            const maxValue = parseInt(input.getAttribute('max')) || 50;
            const newValue = Math.max(0, Math.min(maxValue, currentValue + change));
            input.value = newValue;

            // Trigger change event to update summary
            input.dispatchEvent(new Event('input'));
        }

        // Filtros de productos
        document.addEventListener('DOMContentLoaded', function() {
            const filterButtons = document.querySelectorAll('[data-filter]');
            const products = document.querySelectorAll('[data-category]');

            filterButtons.forEach(button => {
                button.addEventListener('click', function() {
                    const filter = this.getAttribute('data-filter');

                    // Actualizar botones activos
                    filterButtons.forEach(btn => btn.classList.remove('active'));
                    this.classList.add('active');

                    // Filtrar productos
                    products.forEach(product => {
                        if (filter === 'all' || product.getAttribute('data-category') === filter) {
                            product.style.display = 'block';
                        } else {
                            product.style.display = 'none';
                        }
                    });
                });
            });
        });

        // Mejorar la animación de las tarjetas de producto
        document.querySelectorAll('.product-card:not(.out-of-stock)').forEach(card => {
            card.addEventListener('mouseenter', function() {
                this.style.transform = 'translateY(-5px)';
                this.style.boxShadow = 'var(--shadow-medium)';
            });

            card.addEventListener('mouseleave', function() {
                this.style.transform = 'translateY(0)';
                this.style.boxShadow = 'var(--shadow-soft)';
            });
        });

        // Validación en tiempo real
        document.getElementById('orderForm').addEventListener('submit', function(e) {
            const quantities = [
                'QuantityMedioMolido250g',
                'QuantityMedioMolido500g',
                'QuantityOscuroMolido250g',
                'QuantityOscuroMolido500g',
                'QuantityMedioGrano250g',
                'QuantityMedioGrano500g'
            ];

            let hasProducts = false;
            quantities.forEach(id => {
                const input = document.getElementById(id);
                if (input && !input.disabled) {
                    const qty = parseInt(input.value) || 0;
                    if (qty > 0) hasProducts = true;
                }
            });

            if (!hasProducts) {
                e.preventDefault();
                alert('Por favor selecciona al menos un producto disponible');
                return false;
            }
        });
    </script>
}